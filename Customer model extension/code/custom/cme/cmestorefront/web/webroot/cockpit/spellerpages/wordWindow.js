function wordWindow(){this._forms=[];this._getWordObject=_getWordObject;this._wordInputStr=_wordInputStr;this._adjustIndexes=_adjustIndexes;this._isWordChar=_isWordChar;this._lastPos=_lastPos;this.wordChar=/[a-zA-Z]/;this.windowType="wordWindow";this.originalSpellings=new Array();this.suggestions=new Array();this.checkWordBgColor="pink";this.normWordBgColor="white";this.text="";this.textInputs=new Array();this.indexes=new Array();this.resetForm=resetForm;this.totalMisspellings=totalMisspellings;this.totalWords=totalWords;this.totalPreviousWords=totalPreviousWords;this.getTextVal=getTextVal;this.setFocus=setFocus;this.removeFocus=removeFocus;this.setText=setText;this.writeBody=writeBody;this.printForHtml=printForHtml}function resetForm(){if(this._forms){for(var A=0;A<this._forms.length;A++){this._forms[A].reset()}}return true}function totalMisspellings(){var B=0;for(var A=0;A<this.textInputs.length;A++){B+=this.totalWords(A)}return B}function totalWords(A){return this.originalSpellings[A].length}function totalPreviousWords(D,A){var E=0;for(var C=0;C<=D;C++){for(var B=0;B<this.totalWords(C);B++){if(C==D&&B==A){break}else{E++}}}return E}function getTextVal(B,A){var C=this._getWordObject(B,A);if(C){return C.value}}function setFocus(B,A){var C=this._getWordObject(B,A);if(C){if(C.type=="text"){C.focus();C.style.backgroundColor=this.checkWordBgColor}}}function removeFocus(B,A){var C=this._getWordObject(B,A);if(C){if(C.type=="text"){C.blur();C.style.backgroundColor=this.normWordBgColor}}}function setText(B,D,E){var A=this._getWordObject(B,D);var F;var C;if(A){var G=this.indexes[B][D];var I=A.value;F=this.textInputs[B].substring(0,G);C=this.textInputs[B].substring(G+I.length,this.textInputs[B].length);this.textInputs[B]=F+E+C;var H=E.length-I.length;this._adjustIndexes(B,D,H);A.size=E.length;A.value=E;this.removeFocus(B,D)}}function writeBody(){var D=window.document;var A=false;D.open();for(var J=0;J<this.textInputs.length;J++){var I=0;var H=0;D.writeln('<form name="textInput'+J+'">');var K=this.textInputs[J];this.indexes[J]=[];if(K){var G=this.originalSpellings[J];if(!G){break}D.writeln('<div class="plainText">');for(var C=0;C<G.length;C++){do{H=K.indexOf(G[C],I);I=H+G[C].length;if(H==-1){break}var F=K.charAt(H-1);var E=K.charAt(I)}while(this._isWordChar(F)||this._isWordChar(E));this.indexes[J][C]=H;for(var B=this._lastPos(J,C);B<H;B++){D.write(this.printForHtml(K.charAt(B)))}D.write(this._wordInputStr(G[C]));if(C==G.length-1){D.write(printForHtml(K.substr(I)))}}D.writeln("</div>")}D.writeln("</form>")}this._forms=D.forms;D.close()}function _lastPos(B,A){if(A>0){return this.indexes[B][A-1]+this.originalSpellings[B][A-1].length}else{return 0}}function printForHtml(A){return A}function _isWordChar(A){if(A.search(this.wordChar)==-1){return false}else{return true}}function _getWordObject(B,A){if(this._forms[B]){if(this._forms[B].elements[A]){return this._forms[B].elements[A]}}return null}function _wordInputStr(A){var B="<input readonly ";B+='class="blend" type="text" value="'+A+'" size="'+A.length+'">';return B}function _adjustIndexes(D,A,B){for(var C=A+1;C<this.originalSpellings[D].length;C++){this.indexes[D][C]=this.indexes[D][C]+B}};